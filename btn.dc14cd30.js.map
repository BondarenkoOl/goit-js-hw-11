{"mappings":"gkBAMA,MAAMA,EAAaC,SAASC,cAAc,gBACpCC,EAAUF,SAASC,cAAc,YACjCE,EAAcH,SAASC,cAAc,cACrCG,EAAkBJ,SAASC,cAAc,kBAE/C,IAAII,EAAQ,GACRC,EAAO,EACPC,EAAa,EAsEjB,SAASC,EAAcC,GACrB,MAAMC,EAAgBD,EACnBE,KACC,EAACC,GACCA,EAAEC,cACFA,EAAaC,aACbA,EAAYC,KACZA,EAAIC,MACJA,EAAKC,MACLA,EAAKC,SACLA,EAAQC,UACRA,KAEO,oDACkCN,wDACCD,sCAClBE,WAAsBC,yJAGXC,4HAGAC,+HAGGC,gIAGCC,sHAQ1CC,KAAK,IAERlB,EAAQmB,mBAAmB,YAAaX,GAzG1CX,EAAWuB,iBAAiB,UAG5BC,eAA4BC,GAU1B,GATAA,EAAEC,iBAEFnB,EAAO,EACPD,EAAQmB,EAAEE,cAAcC,YAAYC,MAAMC,OAC1C3B,EAAQ4B,UAAY,GAEpB3B,EAAY4B,UAAUC,IAAI,aAC1B5B,EAAgB2B,UAAUC,IAAI,aAEhB,KAAV3B,EAEF,YAkGF4B,EAAAC,GAASC,OAAOC,QAAQ,+BA/FxB,IACE,MACMC,SADe,EAAAC,EAAAC,UAASlC,EAAOC,EArBzB,KAsBWkC,KAIvB,GAHAjC,EAAa8B,EAAQI,KAAKC,OAGA,IAAtBL,EAAQM,UA6FdV,EAAAC,GAASC,OAAOC,QACd,kEA5FO,CACL5B,EAAc6B,EAAQI,MAiF5B,SAA4BJ,GAC1BJ,EAAAC,GAASC,OAAOS,QAAQ,oBAAoBP,EAAQM,qBAjFhDE,CAAmBR,GACI,IAAIJ,EAAAa,GAAJ,CAAmB,cAAcC,UAGtDV,EAAQM,UAlCA,IAmCVxC,EAAY4B,UAAUiB,OAAO,aA0FjCC,OAAOC,SAAS,CACdC,IAAK,EACLC,SAAU,WAxFV,MAAOC,GACPpB,EAAAC,GAASC,OAAOC,QAAQ,oCArC5BjC,EAAYmB,iBAAiB,SAyC7BC,iBACEjB,GAAQ,EAER,IACE,MACM+B,SADe,EAAAC,EAAAC,UAASlC,EAAOC,EAhDzB,KAiDWkC,KAEjBG,EAAYN,EAAQM,UAC1BpC,GAAc8B,EAAQI,KAAKC,OAG3BlC,EAAc6B,EAAQI,MACC,IAAIR,EAAAa,GAAJ,CAAmB,cAAcC,UAEpDxC,IAAeoC,IACjBxC,EAAY4B,UAAUC,IAAI,aAC1B5B,EAAgB2B,UAAUiB,OAAO,cAuEvC,WACE,MAAQM,OAAQC,GAAevD,SAC5BC,cAAc,YACduD,kBAAkBC,wBAErBR,OAAOC,SAAS,CACdC,IAAkB,EAAbI,EACLH,SAAU,WA3EVM,GACA,MAAOL,GACPpB,EAAAC,GAASC,OAAOC,QAAQ","sources":["src/js/btn.js"],"sourcesContent":["import '../css/styles.css';\nimport { fetchImg } from './fetchImg';\nimport Notiflix from 'notiflix';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst searchForm = document.querySelector('#search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst endOfSearchText = document.querySelector('.gallery__text');\n\nlet query = '';\nlet page = 1;\nlet loadedHits = 0;\nconst perPage = 30;\n\nsearchForm.addEventListener('submit', onSearchForm);\nloadMoreBtn.addEventListener('click', onLoadMoreBtn);\n\nasync function onSearchForm(e) {\n  e.preventDefault();\n\n  page = 1;\n  query = e.currentTarget.searchQuery.value.trim();\n  gallery.innerHTML = '';\n\n  loadMoreBtn.classList.add('is-hidden');\n  endOfSearchText.classList.add('is-hidden');\n\n  if (query === '') {\n    alertEmptySearch();\n    return;\n  }\n\n  try {\n    const object = await fetchImg(query, page, perPage);\n    const objData = object.data;\n    loadedHits = objData.hits.length;\n    // console.log('first', loadedHits)\n\n    if (objData.totalHits === 0) {\n      alertNoImagesFound();\n    } else {\n      renderGallery(objData.hits);\n      alertImagesToFound(objData);\n      const simpleLightBox = new SimpleLightbox('.gallery a').refresh();\n    }\n\n    if (objData.totalHits > perPage) {\n      loadMoreBtn.classList.remove('is-hidden');\n    }\n\n    onScroll();\n  } catch (error) {\n    Notiflix.Notify.failure('Ooops...Something goes wrong');\n  }\n}\n\nasync function onLoadMoreBtn() {\n  page += 1;\n\n  try {\n    const object = await fetchImg(query, page, perPage);\n    const objData = object.data;\n    // const totalPages = Math.ceil(objData.totalHits / perPage);\n    const totalHits = objData.totalHits;\n    loadedHits += objData.hits.length;\n    // console.log('second', loadedHits)\n\n    renderGallery(objData.hits);\n    const simpleLightbox = new SimpleLightbox('.gallery a').refresh();\n\n    if (loadedHits === totalHits) {\n      loadMoreBtn.classList.add('is-hidden');\n      endOfSearchText.classList.remove('is-hidden');\n    }\n\n    onScrollMore();\n  } catch (error) {\n    Notiflix.Notify.failure('Ooops...Something goes wrong');\n  }\n}\n\nfunction renderGallery(images) {\n  const galleryMarkup = images\n    .map(\n      ({\n        id,\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n                <a class=\"gallery__link\" href=\"${largeImageURL}\">\n                    <div class=\"photo-card\" id=\"${id}\">\n                    <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n                    <div class=\"info\">\n                        <p class=\"info-item\">\n                            <b>Likes</b> ${likes}\n                        </p>\n                        <p class=\"info-item\">\n                            <b>Views</b> ${views}\n                        </p>\n                        <p class=\"info-item\">\n                            <b>Comments</b> ${comments}\n                        </p>\n                        <p class=\"info-item\">\n                            <b>Downloads</b> ${downloads}\n                        </p>\n                    </div>\n                </div>\n                </a>\n      `;\n      }\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', galleryMarkup);\n}\n\nfunction alertImagesToFound(objData) {\n  Notiflix.Notify.success(`Hooray! We found ${objData.totalHits} images.`);\n}\n\nfunction alertEmptySearch() {\n  Notiflix.Notify.failure('This field cannot be empty!');\n}\n\nfunction alertNoImagesFound() {\n  Notiflix.Notify.failure(\n    'No images were found for this request, try something else.'\n  );\n}\n\nfunction onScroll() {\n  window.scrollBy({\n    top: 0,\n    behavior: 'smooth',\n  });\n}\n\nfunction onScrollMore() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["$cbf510e049c0cba6$var$searchForm","document","querySelector","$cbf510e049c0cba6$var$gallery","$cbf510e049c0cba6$var$loadMoreBtn","$cbf510e049c0cba6$var$endOfSearchText","$cbf510e049c0cba6$var$query","$cbf510e049c0cba6$var$page","$cbf510e049c0cba6$var$loadedHits","$cbf510e049c0cba6$var$renderGallery","images","galleryMarkup","map","id","largeImageURL","webformatURL","tags","likes","views","comments","downloads","join","insertAdjacentHTML","addEventListener","async","e","preventDefault","currentTarget","searchQuery","value","trim","innerHTML","classList","add","$parcel$interopDefault","$eWCmQ","Notify","failure","objData","$dOcJw","fetchImg","data","hits","length","totalHits","success","$cbf510e049c0cba6$var$alertImagesToFound","$fZKcF","refresh","remove","window","scrollBy","top","behavior","error","height","cardHeight","firstElementChild","getBoundingClientRect","$cbf510e049c0cba6$var$onScrollMore"],"version":3,"file":"btn.dc14cd30.js.map"}